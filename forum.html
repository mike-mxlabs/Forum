<html>
<head>
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.0.0.debug.js" ></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" ></script>
    <style>
        @import url('http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css');
        
        .mainform{width:500px; background-color:#efefef; padding:25px;}
    </style>
</head>
<body>
    <h1>Flat Forum</h1>


<table >

<tbody data-bind="foreach: commentsList">
    <tr>
        <td>
             <p><b><span data-bind="text: owner"></span>:</b>  <span data-bind="text: commenttext"></span></p>
         </td>
     
    </tr>
</tbody>
</table>
<br />  

 <form class="mainform">
 <h3>Add your comment</h3><br />  
  <div class="form-group">
   <input type="text" id="name" placeholder="Your Name" class="form-control"/>
  </div>
  
  <div class="form-group">
    <textarea type="text" id="comment" placeholder="Your comment" class="form-control"></textarea>
  </div>

 <button data-bind="click: addItem">add comment</button>
</form>

 <hr />
  <button data-bind="click: save">Save/Debug</button>

    <script>
        function Comment(commenttext, owner) {
              var self = this;
              self.commenttext = ko.observable(commenttext);
              self.owner = ko.observable(owner);
        }

        function CommentsModel() {
            var self = this;

            //Initial data for demo
           // self.commentsList = ko.observableArray
           // ([ new Comment("Comment one","bob"),
            //   new Comment("Another job", "jo")
            // ]);

        //Load data with GET from forum API
            $.ajax({
                type: "GET",
                url: "forumAPI.html",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    alert(data);
                    self.commentsList(data); //Put the response in ObservableArray
                },
                error: function (error) {
                    alert(error.status + "<--and--> " + error.statusText);
                }

            });


            //Functions
            self.addItem = function () {
                self.commentsList.push(new Comment($('#comment').val(), $('#name').val()));
            }

            self.save=function(item)
            {
                var jsonData = ko.toJSON(self.commentsList);
                alert(jsonData);
            }

        }


        ko.applyBindings(new CommentsModel());

    </script>
 <style>
 .isDone{color:Silver;}
 
 </style>
</body>
</html>
